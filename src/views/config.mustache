{{>partials/head}}
    <header>
        <a href="/" class="user">{{user.name}}</a>
        <nav>
            <ul>
                <li><a href="/logout" class="logout">Logout</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="container">
            <form action="/config" method="POST">
                {{#message}}
                    <div class="msg err">{{.}} <p>x</p></div>
                {{/message}}
                <h2>{{title}}</h2>

                <input type="text" name="name" value="{{user.name}}">
                <input type="email" name="email" value="{{user.email}}">
                <input type="password" name="new_password" placeholder="Nova Senha">
                {{#noPassword}}
                    <input type="password" name="current_password" placeholder="Senha Atual">
                {{/noPassword}}

                <label> Autenticação por Celular 
                    {{#checked}}
                        <input type="checkbox" checked name="phone_auth_toggle">
                    {{/checked}}
                    {{^checked}}
                        <input type="checkbox" name="phone_auth_toggle">
                    {{/checked}}
                </label>

                <button id="button">Enviar</button>
            </form>

            <button id="open_panel" class="danger">Deletar Usuário</a>
        </div>

        <div class="panel hidden">
            <h3>Digite sua Senha para Deletar o Usuário</h3>
                <form method="POST" action="/deleteuser">
                    <input type="password" name="password"/>
                <button>Enviar</button>
            </form>
        </div>
        <div class="background hidden"></div>
    </main>

    <script>
        const btn = document.querySelector('#open_panel');
        const panel = document.querySelector('.panel');
        const main = document.querySelector('main');
        const background = document.querySelector('.background');
        let clickInPanel = false;
        
        btn.addEventListener('click', () =>{
            panel.classList.remove('hidden');
            background.classList.remove('hidden');
            
            setTimeout( () =>{
                main.addEventListener('click', outClick);
                
                function outClick(e){

                    if(!clickInPanel){
                        panel.classList.add('hidden');
                        background.classList.add('hidden');
                        main.removeEventListener('click', outClick);
                    }

                    clickInPanel = false;
                }
            }, 10);
        });

        panel.addEventListener('click', () => clickInPanel = true);
    </script>

{{>partials/footer}}